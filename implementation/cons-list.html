<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <title>The Cons List</title>

    <link rel="stylesheet" type="text/css" href="../rust-book.css">

    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    <div id="nav">
                <button id="toggle-nav">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="bar"></span>
                  <span class="bar"></span>
                  <span class="bar"></span>
                </button>
              </div>
<div id='toc' class='mobile-hidden'>
<ul class='chapter'>
<li><a href='../README.html'><b>1.</b> Introduction</a>
</li>
<li><a href='../background/index.html'><b>2.</b> Background</a>
<ul class='section'>
<li><a href='../background/goals.html'><b>2.1.</b> Goals</a>
</li>
<li><a href='../background/why-vm.html'><b>2.2.</b> Why a virtual machine?</a>
</li>
<li><a href='../background/why-lisp.html'><b>2.3.</b> Why Lisp?</a>
</li>
<li><a href='../background/influences.html'><b>2.4.</b> Influences</a>
</li>
</ul>
</li>
<li><a href='../implementation/README.html'><b>3.</b> Implementation</a>
<ul class='section'>
<li><a href='../implementation/why-rust.html'><b>3.1.</b> Why Rust?</a>
</li>
<li><a href='../implementation/overview.html'><b>3.2.</b> Overview</a>
</li>
<li><a href='../implementation/cons-list.html'><b>3.3.</b> The Singly-Linked List</a>
</li>
<li><a href='../implementation/secd.html'><b>3.4.</b> The SECD Architecture</a>
</li>
<li><a href='../implementation/svm.html'><b>3.5.</b> Seax Virtual Machine</a>
</li>
<li><a href='../implementation/scheme.html'><b>3.6.</b> Seax Scheme</a>
</li>
</ul>
</li>
</ul>
</div>
<div id='page-wrapper'>
<div id='page'>


    <h1 class="title">The Cons List</h1>
    <p>In order to understand both the Lisp programming language and the SECD machine, it is necessary to understand the singly-linked list, or <code>cons</code> list. </p>

<h2 id="the-cons-cell" class='section-header'><a
                           href="#the-cons-cell">The Cons Cell</a></h2>
<p>The <code>cons</code> list is one of the most conceptually simple data structures possible. It consists of one fundamental function, the eponymous <code>cons</code>, short for <i>cons</i>truct. The <code>cons</code> function creates memory objects, called <em><code>cons</code> cells</em> or <em>pairs</em>, which contain two values or pointers.</p>

<p>Typically, a <code>cons</code> cell is written using the &#39;dotted pair&#39; notation <code>(a . b)</code>, where <code>a</code> refers to the first element, or <code>car</code>, and <code>b</code> refers to the second element, or <code>cdr</code>. These (admittedly rather arcane) names are acronyms, meaning &#39;<i>C</i>ontents of the <i>A</i>ddress part of the <i>R</i>egister number&#39; and &#39;<i>C</i>ontents of the <i>D</i>ecrement part of the <i>R</i>egister number&#39;, which refer to hardware instructions on the <a href="http://en.wikipedia.org/wiki/IBM_704">IBM 704</a> computers on which Lisp was first implemented in the late 1950s. Although these hardware instructions are now lost to the mists of time, their names are now enshrined in computing lore thanks to Lisp. We will, therefore, continue to use this notation.</p>

<h2 id="the-singly-linked-list" class='section-header'><a
                           href="#the-singly-linked-list">The Singly-Linked List</a></h2>
<p>Despite its&#39; simplicity, the <code>cons</code> cell may be used to implement a variety of data structures, such as lists and trees. We are concerned primarily with the singly-linked list.</p>

<p>In order to implement a singly-linked list using the <code>cons</code> cell, we simply define a list of items as being either of the following:</p>

<ul>
<li>A <code>cons</code> cell whose <code>car</code> is a pointer to an item and whose tail is a pointer to a list</li>
<li>The empty list, called <code>nil</code></li>
</ul>

<p>In programming languages which support algebraic data types, defining such a structure is almost trivially easy. In Rust, it looks something like this:</p>
<span class='rusttest'>fn main() {
    pub enum List&lt;T&gt; {
        /// Cons cell containing a `T` and a link to the tail
        Cons(T, Box&lt;List&lt;T&gt;&gt;),
        /// The empty list.
        Nil
    }
    
}</span><pre id='rust-example-rendered' class='rust '>
<span class='kw'>pub</span> <span class='kw'>enum</span> <span class='ident'>List</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;</span> {
    <span class='doccomment'>/// Cons cell containing a `T` and a link to the tail</span>
    <span class='ident'>Cons</span>(<span class='ident'>T</span>, <span class='ident'>Box</span><span class='op'>&lt;</span><span class='ident'>List</span><span class='op'>&lt;</span><span class='ident'>T</span><span class='op'>&gt;&gt;</span>),
    <span class='doccomment'>/// The empty list.</span>
    <span class='ident'>Nil</span>
}
</pre>

<p>Do note that the Rust implementation is somewhat more complicated due to Rust&#39;s memory management and typing discipline. In Scheme, we can say, even more simply:</p>

<pre><code class="language-scheme">(define (cons a b) (lambda (x) (x a b)))
</code></pre>

<p>Therefore, by repeatedly <code>cons</code>ing together a series of items, a singly linked list is created. Each <code>cons</code> cell in the list contains as its <code>car</code> a pointer to an item, while its <code>cdr</code> is a pointer to the remainder (or <em>tail</em>) of the list, and the list may be traversed by following the <code>cdr</code>s from the head element down. The <code>cdr</code> of the last item in the list points to <code>nil</code>, the empty-list symbol. </p>

<p>For example, a list of numbers 1 through 4 could be represented by the list <code>(1 . (2 . (3 . (4 . nil ))))</code>. Since typing out such expressions will quickly become rather time-consuming (and may lead to a national perentheses shortage), we may use the shorthands <code>(1,2,3,4)</code> or <code>(1 2 3 4)</code> to refer to such a list.</p>

<p>For more information on the singly-linked <code>cons</code> list as used in Seax, please consult the <a href="http://hawkweisman.me/seax/api/seax_svm/slist/index.html">API documentation</a> for <code>seax_svm::slist</code>.</p>

    <script type="text/javascript">
        window.playgroundUrl = "http://play.rust-lang.org";
    </script>
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function(event) {
  document.getElementById("toggle-nav").onclick = toggleNav;
  function toggleNav() {
    var toc = document.getElementById("toc");
    var pagewrapper = document.getElementById("page-wrapper");
    toggleClass(toc, "mobile-hidden");
    toggleClass(pagewrapper, "mobile-hidden");
  };

  function toggleClass(el, className) {
     // from http://youmightnotneedjquery.com/
     if (el.classList) {
       el.classList.toggle(className);
     } else {
       var classes = el.className.split(' ');
       var existingIndex = classes.indexOf(className);

       if (existingIndex >= 0) {
         classes.splice(existingIndex, 1);
       } else {
         classes.push(className);
       }

       el.className = classes.join(' ');
     }
  }

  // The below code is used to add prev and next navigation links to the bottom
  // of each of the sections.
  // It works by extracting the current page based on the url and iterates over
  // the menu links until it finds the menu item for the current page. We then
  // create a copy of the preceding and following menu links and add the
  // correct css class and insert them into the bottom of the page.
  var toc = document.getElementById('toc').getElementsByTagName('a');
  var href = document.location.pathname.split('/').pop();
  if (href === 'index.html' || href === '') {
    href = 'README.html';
  }

  for (var i = 0; i < toc.length; i++) {
    if (toc[i].attributes['href'].value.split('/').pop() === href) {
      var nav = document.createElement('p');
      if (i > 0) {
        var prevNode = toc[i-1].cloneNode(true);
        prevNode.className = 'left';
        nav.appendChild(prevNode);
      }
      if (i < toc.length - 1) {
        var nextNode = toc[i+1].cloneNode(true);
        nextNode.className = 'right';
        nav.appendChild(nextNode);
      }
      document.getElementById('page').appendChild(nav);
      break;
    }
  }

});
</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="playpen.js"></script>
</div></div>


</body>
</html>